function(add_client_test test_src test_name)
  add_executable(${test_name} "${test_src}")
  target_include_directories(${test_name} PUBLIC ${PROJECT_SOURCE_DIR}/src ${IOTA_CLIENT_EXTERNAL_HEADERS})
  add_dependencies(${test_name} iota_cclient)
  if(HAS_ASAN_ENABLED)
    target_link_libraries(${test_name} PRIVATE asan)
  endif()
  target_link_libraries(${test_name} PUBLIC iota_cclient iota_common ${IOTA_COMMON_EXT_LIBS} unity ${IOTA_CLIENT_EXT_LIBS})
  add_test(${test_name} ${test_name})
endfunction(add_client_test)

add_client_test("test_http.c" test_http)